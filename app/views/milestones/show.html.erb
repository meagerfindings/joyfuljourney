<h1><%= @milestone.title %></h1>

<div class="milestone-details">
  <p><strong>Date:</strong> <%= @milestone.milestone_date.strftime("%B %d, %Y") %></p>
  <p><strong>Type:</strong> <%= @milestone.milestone_type_display %></p>
  
  <% if @milestone.description.present? %>
    <div>
      <strong>Description:</strong>
      <p><%= simple_format(@milestone.description) %></p>
    </div>
  <% end %>

  <p><strong>For:</strong> 
    <% case @milestone.milestoneable_type %>
    <% when 'User' %>
      <%= link_to @milestone.milestoneable.name, @milestone.milestoneable %>
    <% when 'Family' %>
      <%= link_to "#{@milestone.milestoneable.name} family", @milestone.milestoneable %>
    <% when 'Post' %>
      <%= link_to "Post \"#{@milestone.milestoneable.title}\"", @milestone.milestoneable %>
    <% end %>
  </p>

  <p><small class="text-muted">Created by <%= @milestone.created_by_user.name %> on <%= @milestone.created_at.strftime("%B %d, %Y") %></small></p>
  
  <% if @milestone.is_private %>
    <span class="badge badge-warning">Private Milestone</span>
  <% end %>
</div>

<div class="milestone-actions">
  <% if @milestone.created_by_user == current_user || manager_or_admin? %>
    <%= link_to "Edit", edit_milestone_path(@milestone), class: "btn btn-secondary" %>
    <%= link_to "Delete", milestone_path(@milestone), method: :delete, 
                confirm: "Are you sure you want to delete this milestone?", 
                class: "btn btn-danger" %>
  <% end %>
  
  <%= link_to "Back to Milestones", milestones_path, class: "btn btn-light" %>
  
  <% if @milestone.milestoneable %>
    <%= link_to "Back to #{@milestone.milestoneable_type}", 
                polymorphic_path([@milestone.milestoneable, :milestones]), 
                class: "btn btn-light" %>
  <% end %>
</div>