<div class="card">
  <div class="card-header d-flex justify-content-between align-items-center">
    <h5 class="mb-0">
      <i class="bi bi-clock-history me-2"></i>Recent Activity
    </h5>
    <%= link_to "View All", timeline_index_path, class: "btn btn-sm btn-outline-primary" %>
  </div>
  <div class="card-body">
    <% if @timeline_items.any? %>
      <div class="timeline-truncated">
        <% @timeline_items.each_with_index do |item, index| %>
          <div class="timeline-item-small mb-3 <%= 'border-bottom pb-3' unless index == @timeline_items.length - 1 %>">
            <div class="row align-items-center">
              <div class="col-1">
                <% if item.is_a?(Post) %>
                  <i class="bi bi-file-text text-primary"></i>
                <% elsif item.is_a?(Milestone) %>
                  <i class="bi bi-trophy text-success"></i>
                <% end %>
              </div>
              <div class="col-8">
                <% if item.is_a?(Post) %>
                  <div class="fw-semibold">
                    <%= link_to truncate(item.title, length: 40), post_path(item), class: "text-decoration-none" %>
                  </div>
                  <small class="text-muted">
                    by <%= item.user.first_name || item.user.username %>
                  </small>
                <% elsif item.is_a?(Milestone) %>
                  <div class="fw-semibold">
                    <%= link_to truncate(item.title, length: 40), milestone_path(item), class: "text-decoration-none" %>
                  </div>
                  <small class="text-muted">
                    <span class="badge bg-success bg-opacity-10 text-success"><%= item.milestone_type_display %></span>
                    by <%= item.created_by_user.first_name || item.created_by_user.username %>
                  </small>
                <% end %>
              </div>
              <div class="col-3 text-end">
                <small class="text-muted">
                  <%= case item
                      when Post
                        time_ago_in_words(item.created_at) + " ago"
                      when Milestone
                        item.milestone_date.strftime("%b %d")
                      end %>
                </small>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    <% else %>
      <div class="text-center py-4">
        <i class="bi bi-inbox text-muted mb-2" style="font-size: 2rem;"></i>
        <p class="text-muted mb-0">No recent activity</p>
        <small class="text-muted">Create some posts or milestones to get started!</small>
      </div>
    <% end %>
  </div>
</div>