<% is_user_post_index = @user %>
<% index_header_string = is_user_post_index ? "#{@user.name}'s Posts" : "All Posts" %>

<h1><%= index_header_string %></h1>

<%= link_to "New Memory", new_post_path %>

<ul>
  <% @posts.each do |post| %>
    <li id="post-<%= post.id %>">
      <%= link_to post.title, post %>
      <br/>
      <p><%= post.body %></p>
      <p>by: <%= post.user.name %></p>
      <% if post.tagged_users.any? %>
        <p>
          <small class="text-muted">
            Tagged: 
            <% post.tagged_users.each_with_index do |tagged_user, index| %>
              <%= tagged_user.name %><%= " (#{tagged_user.display_age})" if tagged_user.display_age %><%= ", " unless index == post.tagged_users.count - 1 %>
            <% end %>
          </small>
        </p>
      <% end %>
    </li>
  <% end %>
</ul>
